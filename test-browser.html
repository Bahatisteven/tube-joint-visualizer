<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tube Joint Visualizer - Browser Test</title>
    <link rel="stylesheet" href="src/renderer/styles.css">
</head>
<body>
    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel">
            <h2>Tube Joint Visualizer</h2>
            <p style="color: #4a9eff; font-size: 12px; margin-bottom: 15px;">Browser Test Version</p>
            
            <div class="section">
                <h3>Tube Type</h3>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="tubeType" value="rectangular" checked>
                        Rectangular
                    </label>
                    <label>
                        <input type="radio" name="tubeType" value="square">
                        Square
                    </label>
                </div>
            </div>

            <div class="section">
                <h3>Dimensions (mm)</h3>
                
                <div class="input-group">
                    <label>Width:</label>
                    <input type="number" id="width" value="100" min="10" max="500" step="5">
                    <span class="unit">mm</span>
                </div>

                <div class="input-group" id="heightGroup">
                    <label>Height:</label>
                    <input type="number" id="height" value="50" min="10" max="500" step="5">
                    <span class="unit">mm</span>
                </div>

                <div class="input-group">
                    <label>Thickness:</label>
                    <input type="number" id="thickness" value="3" min="1" max="20" step="0.5">
                    <span class="unit">mm</span>
                </div>

                <div class="input-group">
                    <label>Length:</label>
                    <input type="number" id="length" value="500" min="50" max="2000" step="10">
                    <span class="unit">mm</span>
                </div>
            </div>

            <div class="section">
                <button id="addTube" class="btn btn-primary">+ Add Tube</button>
                <button id="deleteTube" class="btn btn-danger">Delete Selected</button>
            </div>

            <div class="section">
                <h3>View Mode</h3>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="viewMode" value="solid" checked>
                        Solid
                    </label>
                    <label>
                        <input type="radio" name="viewMode" value="wireframe">
                        Wireframe
                    </label>
                </div>
            </div>

            <div class="section">
                <h3>Actions</h3>
                <button id="undo" class="btn">‚Ü∂ Undo</button>
                <button id="redo" class="btn">‚Ü∑ Redo</button>
            </div>

            <div class="section info-panel">
                <h3>Info</h3>
                <div id="tubeCount">Tubes: 0</div>
                <div id="jointInfo">Joints: 0</div>
                <div id="selectedInfo">Selected: None</div>
            </div>
            
            <div class="section">
                <h3>Debug Console</h3>
                <div id="debugConsole" style="background: #1a1a1a; padding: 10px; border-radius: 4px; font-size: 11px; max-height: 200px; overflow-y: auto; font-family: monospace; color: #00ff00;"></div>
            </div>
        </div>

        <!-- 3D Viewport -->
        <div class="viewport">
            <div id="canvas-container"></div>
            <div class="viewport-overlay">
                <div class="help-text">
                    <strong>Controls:</strong><br>
                    Left Click + Drag: Rotate view<br>
                    Right Click + Drag: Pan view<br>
                    Mouse Wheel: Zoom<br>
                    Click Tube: Select<br>
                    G: Grab/Move selected tube<br>
                    <br>
                    <strong>Check browser console (F12) for detailed logs!</strong>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "./node_modules/three/build/three.module.js",
            "three/addons/": "./node_modules/three/examples/jsm/"
        }
    }
    </script>
    
    <script>
        // Debug console helper
        const debugConsole = document.getElementById('debugConsole');
        const originalLog = console.log;
        const originalError = console.error;
        
        function addDebugMessage(msg, type = 'log') {
            const color = type === 'error' ? '#ff4444' : '#00ff00';
            const line = document.createElement('div');
            line.style.color = color;
            line.textContent = msg;
            debugConsole.appendChild(line);
            debugConsole.scrollTop = debugConsole.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addDebugMessage(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addDebugMessage('ERROR: ' + args.join(' '), 'error');
        };
        
        console.log('üåê Browser test version loaded');
    </script>
    
    <script type="module" src="src/renderer/app.js"></script>
</body>
</html>
